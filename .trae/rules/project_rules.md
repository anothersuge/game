🧾 项目名称：绿萝狼锐评（暂定）
🎯 项目目标
构建一个供朋友间使用的游戏评价网站，用户可以：

浏览游戏信息
发表评价和评分
查看朋友的评价
进行简单的互动（点赞、评论）
📌 核心功能模块
1. 用户系统
用户注册 / 登录 / 注销
用户资料查看与编辑（昵称、头像、简介）
好友系统（添加好友、查看好友列表）
2. 游戏信息管理
游戏列表展示（分页、搜索、筛选）
游戏详情页（基本信息、评分、评价列表）
游戏添加 / 编辑 / 删除（管理员权限）
3. 评价系统
用户对游戏进行评分（1-5星，每半星一个间隔）
撰写评价（支持 Markdown）
点赞 / 评论其他用户的评价
查看游戏的平均评分和评价统计
4. 社交互动
好友动态流（朋友最近评价了哪些游戏）
点赞 / 评论通知
简单的排行榜（评分最高的游戏、活跃用户）
5. 管理后台（可选）
用户管理
游戏数据管理
举报处理（如果需要）
🏗️ 技术架构描述
后端架构（Spring Boot 3）+java21
框架：Spring Boot 3 + Spring Security + Spring Data JPA
数据库：sqlite
模板引擎：Thymeleaf（前后端不分离）
缓存：Redis（用于排行榜、热门游戏等）
日志：Logback + Spring Actuator
部署：Docker + Nginx（可选）

Nginx 配置：
为了在生产环境中使用 80 端口访问应用，同时避免以 root 权限运行应用，可以使用 Nginx 作为反向代理。
1. 将应用运行在 8080 端口（非特权端口）
2. 配置 Nginx 监听 80 端口并将请求转发到 8080 端口
3. Nginx 配置示例可在项目根目录的 nginx.conf 文件中找到

敏感词过滤：
系统实现了敏感词过滤功能，可以对用户名、游戏名和评论内容进行过滤。
- 敏感词库文件位于 src/main/resources/sensitive-words.txt
- 过滤器实现在 com.lvluolang.game.util.SensitiveWordFilter 类中
- 当检测到敏感词时，系统会静默处理（不保存到数据库但返回成功响应）

数据模型简要设计

✅ 非功能性需求
响应时间 < 1s
支持移动端访问（响应式设计）
数据备份机制
简单权限控制（普通用户 / 管理员）
🚀 开发建议
初期可以只做游戏评价和好友系统，后续再加互动功能。
使用 Bootstrap 或 Tailwind CSS 快速构建前端页面。

记录问题
## 架构问题分析
### 1. 性能优化方面
- N+1 查询问题 ：在 HomeController.gameDetail 方法中，获取游戏详情时先查询游戏信息，然后在模板中可能遍历游戏的评论列表，这可能导致额外的数据库查询。建议使用JOIN FETCH优化查询。
- 排行榜查询效率 ： getTopRatedGames 和 getRecentReviews 等方法直接返回大量数据，对于未来可能的增长没有分页处理。
### 2. 数据一致性问题
- 游戏评分更新 ：在 ReviewService.saveReview 方法中，保存评论后更新游戏的平均评分，但这个操作不是原子性的。如果在计算平均分时有并发操作，可能导致数据不一致。建议使用数据库事务或在数据库层面实现。
- 点赞计数更新 ： ReviewService.likeReview 方法中更新点赞数也不是原子性的，存在并发问题。
### 3. 安全性方面
- IP地址限制 ：当前使用IP地址限制点赞功能，但没有考虑IP地址可能变化的情况，以及IPv6支持问题。对于朋友间使用的场景，可以考虑使用简单的会话标识。
- 敏感词过滤 ：虽然已实现敏感词过滤，但过滤逻辑是在控制器层实现的，建议将其移到服务层或使用AOP实现。
### 4. 代码结构问题
- 业务逻辑重叠 ：在 HomeController.submitReview 方法中同时处理了游戏创建和评论保存的逻辑，建议将游戏创建逻辑移到 GameService 中。
- 重复代码 ：在多个服务类中都有类似的获取客户端IP地址的代码，可以提取到工具类中。
### 5. 数据库设计问题
- 缺少索引 ：在 games 表的 name 、 genre 、 developer 等常用查询字段上缺少索引，可能影响查询性能。
- ReviewLike表设计 ：使用IP地址作为唯一约束可能不够稳定，建议考虑其他标识符。